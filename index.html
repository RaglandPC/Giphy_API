<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Giphy</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>



</head>

<body>

  <div class="container">
    <h1>Giphy</h1>
    <br>


    <!-- Movies will Get Dumped Dere -->
    <div id="musicGEN-view"></div>

    <!-- Rendered Buttons will get Dumped Here  -->
    <div id="buttons-view"></div>



    <form id="music-form">
      <label for="music-input">Add a new Music</label>
      <input type="text" id="music-input">
      <br>
      <!-- Button triggers new movie to be added -->
      <input id="add-music" type="submit" value="Add a new music">
    </form>
    <div class="col-sm-12 col-md-8 d-flex flex-row flex-	wrap" id="gif"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript"></script>
    <script>
      var musicGEN = ["Blues", "Country", "EDM", "Jazz", "Reggae", "Rap"];

      function displayMusicInfo(evt) {
        var music = evt.currentTarget.innerText;

        var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=ZZShI1PABDmDce82Rq8yIAftW20j7BLA&limit=10&offset=0&rating=G&lang=en&q=" + music;

        var staticURL = "https://media4.giphy.com/media/q0JV5wyTwz4CQ/480w_s.jpg" + music;

        //response.data.images.480w_still.url

        $.ajax({
          url: queryURL,
          method: 'GET'
        }).then(function(response) {
          var musicGifsArray = response.data;
          console.log(musicGifsArray);
          // Creating div to hold msuic.then(fuction(response)\
          var musicDIV = $("<div class='music'>").text(response.data);
          for (var i = 0; i <= 10; i++) {
            console.log(i);
            console.log(response.data[i].images.fixed_width.url);
            var iUrl = response.data[i].images.fixed_width.url;
            var musicImage = $("<img>")
            musicImage.attr("src", iUrl, );
            musicImage.attr("alt", "music image");
            $("#gif").prepend(musicImage);

            function animate() {
              // store the url of the clicked gif in a variable
              var clickedURL = $(this).attr("src");
              var state = $(this).attr("class");
              musicImage.addClass("static");
              // testing and debugging
              console.log(state);
              // run a test so we know what state the gif is in
              if (state === 'static') {
                // if the gif is static, animate it and set the state to running
                var dynamicURL = iUrl.split('_s').join('');
                // push it to the screen
                $(this).attr("src", dynamicURL);
                // set the state
                $(this).attr("class", "dynamic");
              } else if (state === 'dynamic') {
                // else if the gif is running, set it back to static
                staticURL = iUrl.split('.gif').join('_s.gif');
                // push it to the screen
                $(this).attr("src", staticURL);
                // set the state
                $(this).attr("class", "static");

              }
            }

          }

        });

      };

// making the buttons show
      function renderButtons() {
        $("#buttons-view").empty();


        for (var i = 0; i < musicGEN.length; i++) {
          var a = $("<button>");

          a.addClass("music-btn");

          a.text(musicGEN[i]);

          $("#buttons-view").append(a);
        }
      }
      // append music to the list

      $("#add-music").on("click", function(e) {
        event.preventDefault();

        var music = $("#music-input").val().trim();

        musicGEN.push(music);

        renderButtons();

      });
      // This is the click for all functions
      $(document).on("click", ".music-btn", displayMusicInfo);




      renderButtons();
    </script>




</body>

</html>
